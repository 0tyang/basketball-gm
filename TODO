MAIN PLAN:
build init_db equivalent with http://aaronpowell.github.com/db.js/
port enough code over to create a new league. is it ridiculously slow?
if not, port enough code over to simulate games. is it ridiculously slow?

IF NOT, THEN:
abstract out all references to database into a library, to allow porting to indexeddb painlessly
other feature porting

---

test deep index stats.tid, stats.season: {pid, stats: {tid, season, pts, reb, ...}}

League schema: teamStats and playerStats refer to totals that will be divided by numGames to get averages

players = {playerAttributes}
Index: pid, tid

playerRatings = {playerRatings}
Index: pid, season

playerStats = {numGames, playerStats}
Index: pid, tid, season

teams = {teamAttributes}
Index: tid, cid, did, season

teamStats = {numGames, teamStats}
Index: tid, season

schedule = {schedule}

gameResults =  {gid, season, teamStatsForIndividualGames, playerStatsForIndividualGame]}
Index: gid, tid, season

conferences, divisions = simple global data structures

Querying based on multiple indexes: https://github.com/philikon/queryIndexedDB
Try that first, as it looks simple. If it doesn't work, try: http://linq2indexeddb.codeplex.com/ http://www.kristofdegrave.be/2012/05/using-linq-to-indexed-db.html
CAN EITHER OF THESE HANDLE JOINS? Intersection and Union in the first, what about second?

var teamStore = dbm.transaction("teams").objectStore("teams");
request = Index('did').eq(2).getAll(teamStore)
request.onsuccess = function (event) {
    console.log(request.result);
}

var dbConfig = {};
dbConfig.version = 1;
var db = window.linq2indexedDB("meta", dbConfig, true);
db.linq.from("leagues").select().then(function(data){
	console.log("Selected " + data.length + " items");
	console.log(data);
});

---

update: http://www.javasscrypt.com/html5/web-sql-db-vs-indexeddb/
tranasctions: http://blog.nparashuram.com/2011/11/indexeddb-apis-javascriptnext.html        http://stackoverflow.com/questions/10484965/how-can-i-put-several-requests-in-one-transaction-in-indexeddb
joins: http://blog.oharagroup.net/post/16394604653/a-performance-comparison-websql-vs-indexeddb        http://hacks.mozilla.org/2010/06/comparing-indexeddb-and-webdatabase/

handlebars templates -f js/templates.js

On page load:
- load main wrapper template and display
- load league internal wrapper but don't display
- if within league and internal league wrapper not displayed, display it
- display content from view (title, content, league_content)
  - do this within the view functions. have a function they call, passing a hash with keys matching blocks, and then have that function update the page

TODO:
only pushstate in ajax_update if this is a new URL (not the current URL)
only need handlebars.runtime.js
merge game_attributes into league table of meta database
race contition on "Create New League" button?
